#!/bin/bash
_PATH=/var/migasfree/dump

DUMP_FILE="$1"

if [ -z $DUMP_FILE ]
then
    DUMP_FILE=migasfree.sql
fi

mkdir -p $_PATH || :

export PGPASSWORD=$POSTGRES_PASSWORD
echo "$(date -u) DUMP Database:  $POSTGRES_HOST:$POSTGRES_PORT $POSTGRES_DB to $_PATH/$DUMP_FILE ..."   >> $_PATH/backup.log 2>&1
pg_dump -h $POSTGRES_HOST -p $POSTGRES_PORT $POSTGRES_DB -U $POSTGRES_USER > $_PATH/$DUMP_FILE

echo "$(date -u) DUMP done"  >> $_PATH/backup.log 2>&1
echo ""  >>  $_PATH/backup.log 2>&1
